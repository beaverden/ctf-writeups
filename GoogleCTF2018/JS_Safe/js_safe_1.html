<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>JS Safe - the leading localStorage based safe solution with advanced obfuscation technology</title>

<script>
async function x(password) {
    // TODO: check if they can just use Google to get the password once they understand how this works.
    var code = 'icffjcifkciilckfmckincmfockkpcofqcoircqfscoktcsfucsivcufwcooxcwfycwiAcyfBcwkCcBfDcBiEcDfFcwoGcFfHcFiIcHfJcFkKcJfLcJiMcLfNcwwOcNNPcOOQcPORcQNScRkTcSiUcONVcUoWcOwXcWkYcVkÐ€cYiÐcÐ€fÐ‚cQoÐƒcÐ‚kÐ„cÐƒfÐ…cPNÐ†cÐ…wÐ‡cÐ†oÐˆcÐ‡iÐ‰cÐˆfÐŠcPkÐ‹cÐŠiÐŒcÐ†iÐcÐŒfÐŽcWoÐcÐŽkÐcÐiÐ‘cÐ†kÐ’cÐ‘fÐ“cNkÐ”cÐ“fÐ•cÐ‡kÐ–cÐ•iÐ—cÐ–fÐ˜cRwÐ™cÐ˜oÐšcÐ™kÐ›cUkÐœcÐ›iÐcÐœfÐžcÐ˜kÐŸcÐžiÐ cÐŸfÐ¡cUwÐ¢cÐ¡iÐ£cQkÐ¤cÐ£iÐ¥cÐƒiÐ¦cQwÐ§cÐ¦oÐ¨cÐ§kÐ©cÐ¨iÐªcÐ©fÐ«cRiÐ¬cÐ«fÐ­cÐšiÐ®cÐ­fÐ¯cÐ¡oÐ°cÐ¯iÐ±cÐ“iÐ²cÐ™iÐ³cRoÐ´cÐ³kÐµcÐ´iÐ¶dÐ¢aÐ·cÐ›fÐ¸dÐ·aÐ¶cÐ¶Ð¸Ð¹cÐ¡kÐºdÐ¹aÐ¶cÐ¶ÐºÐ»cÐ¹fÐ¼dÐ»aÐ¶cÐ¶Ð¼Ð½dÐ¢aÐ¶cÐ¶Ð½Ð¾dÐ€aÐ¶cÐ¶Ð¾Ð¿dNaÐ¶cÐ¶Ð¿Ñ€cUiÑcÑ€fÑ‚dÑaÑƒdÐaÑ‚cÑ‚ÑƒÑ‚cÑ‚Ð¾Ñ„cÐ¢fÑ…dÑ„aÑ‚cÑ‚Ñ…Ñ‚cÑ‚ÐºÑ‚cÑ‚Ð½Ñ‚cÑ‚Ð¼Ñ†dÑaÑ‚cÑ‚Ñ†Ñ‚cÑ‚ÐºÑ‚cÑ‚ÑƒÑ‚cÑ‚Ð½Ñ‡aaÑ‚ÑˆdÐ¯aÑ‰cÐ¹iÑŠcÑ‰fÑ‹dÑŠaÑŒcÐ¶Ñ‹ÑcVfÑŽdÑaÑŒcÑŒÑŽÑŒcÑŒÐ¾ÑdÐ›aÑŒcÑŒÑÑŒcÑŒÑƒÑŒcÑŒÑ‹ÑÑ‡ÑˆÑŒÑ‘ÑÑˆÑˆÑ’cOfÑ“dÑ’aÑ“cÑ“Ð½Ñ“cÑ“Ð½Ñ”cUfÑ•dÑ”aÑ“cÑ“Ñ•Ñ–cÐ¯fÑ—dÑ–aÑ“cÑ“Ñ—Ñ˜aÑ‘Ñ“Ñ™aaÑ‚ÑšcÐ¶ÑˆÑ›cÐŽiÑœcÑ›fÑdÑœaÑšcÑšÑÑšcÑšeÑžcÐfÑŸdÑžaÑšcÑšÑŸÑ dÐaÑšcÑšÑ ÑšcÑšÑˆÑšcÑšÑÑšcÑšfÑšcÑšÑŸÑ¡Ñ™ÑˆÑšÑ¢aaÑ‚Ñ£cÐ¶ÑˆÑ£cÑ£ÑÑ£cÑ£eÑ£cÑ£ÑŸÑ¤cÐ¯kÑ¥dÑ¤aÑ£cÑ£Ñ¥Ñ£cÑ£ÑˆÑ£cÑ£ÑÑ£cÑ£fÑ£cÑ£ÑŸÑ¦Ñ¢ÑˆÑ£Ñ§cÑ†Ð½Ñ§cÑ§Ñ—Ñ¨dÐ¡aÑ§cÑ§Ñ¨Ñ§cÑ§ÐºÑ§cÑ§ÑƒÑ©aÑ‘Ñ§ÑªcÑ…Ð¼Ñ«dÑ€aÑªcÑªÑ«ÑªcÑªÐºÑ¬dYaÑªcÑªÑ¬ÑªcÑªÐ¸Ñ­aÑ©ÑªÑ®cÑÑŽÑ¯dÐaÑ®cÑ®Ñ¯Ñ®cÑ®Ð¸Ñ®cÑ®Ñ…Ñ®cÑ®ÐºÑ°aÑ­Ñ®Ñ±dVaÑ²cÑ…Ñ±Ñ²cÑ²Ñ•Ñ³cNoÑ´cÑ³kÑµcÑ´fÑ¶dÑµaÑ²cÑ²Ñ¶Ñ²cÑ²iÑ²cÑ²lÑ²cÑ²mÑ·Ñ˜Ñ²gÑ¸Ñ˜Ñ­Ñ·Ñ¹bÑ°Ñ¸ÑºcXfÑ»dÑºaÑ»cÑ»ÑŽÑ»cÑ»Ð¾Ñ»cÑ»ÐºÑ»cÑ»oÑ¼dÑ’aÑ»cÑ»Ñ¼Ñ»cÑ»Ð½Ñ»cÑ»Ð½Ñ»cÑ»Ñ•Ñ»cÑ»Ñ—Ñ½aÑ‘Ñ»Ñ¾Ñ½Ñ¹ÑˆÑ¿ceeÒ€ceeÒceeÒ‚ceeÑ¿aÑ¾eÒ€Ñ˜Ñ¿TÒ‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾fÒ€Ñ˜Ñ¿VÒ‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾iÒ€Ñ˜Ñ¿UÒ‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾jÒ€Ñ˜Ñ¿XÒ‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾kÒ€Ñ˜Ñ¿ÐÒ‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾lÒ€Ñ˜Ñ¿FÒ‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾mÒ€Ñ˜Ñ¿Ð„Ò‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾nÒ€Ñ˜Ñ¿Ð‰Ò‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾oÒ€Ñ˜Ñ¿Ð„Ò‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾pÒ€Ñ˜Ñ¿Ð‹Ò‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾qÒ€Ñ˜Ñ¿ÐÒ‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾rÒ€Ñ˜Ñ¿ÐÒ‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾sÒ€Ñ˜Ñ¿FÒ‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾tÒ€Ñ˜Ñ¿Ð’Ò‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾uÒ€Ñ˜Ñ¿Ð”Ò‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾vÒ€Ñ˜Ñ¿Ð—Ò‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾wÒ€Ñ˜Ñ¿ÐšÒ‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾xÒ€Ñ˜Ñ¿ÐÒ‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾yÒ€Ñ˜Ñ¿Ð Ò‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾AÒ€Ñ˜Ñ¿Ð¢Ò‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾BÒ€Ñ˜Ñ¿Ð¤Ò‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾CÒ€Ñ˜Ñ¿WÒ‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾DÒ€Ñ˜Ñ¿Ð¥Ò‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾EÒ€Ñ˜Ñ¿ÐªÒ‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾FÒ€Ñ˜Ñ¿Ð¬Ò‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾GÒ€Ñ˜Ñ¿Ð®Ò‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾HÒ€Ñ˜Ñ¿Ð°Ò‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾IÒ€Ñ˜Ñ¿eÒ‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾JÒ€Ñ˜Ñ¿Ð±Ò‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾KÒ€Ñ˜Ñ¿Ð²Ò‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾LÒ€Ñ˜Ñ¿KÒ‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑ¿aÑ¾MÒ€Ñ˜Ñ¿ÐµÒ‚Ñ¡Ò€ÑˆÒÑ˜hÒ‚hÑ¦ÒÑˆÑceeÑ‘ceeÑ“ceeÑ˜ceeÑ™ceeÑšceeÑ¡ceeÑ¢ceeÑ£ceeÑ¦ceeÑ§ceeÑ©ceeÑªceeÑ­ceeÑ®ceeÑ°ceeÑ²ceeÑ·ceeÑ¸ceeÑ¹ceeÑ»ceeÑ½ceeÑ¾ceeÒ€ceeÒceeÐ¶ceeÑ‚ceeÑ‡ceeÑŒcee'

    var fin = '';
    var env = {
        a: (x,y) => x[y],
        b: (x,y) => Function.constructor.apply.apply(x, y),
        c: (x,y) => x+y,
        d: (x) => String.fromCharCode(x),
        e: 0,
        f: 1,
        g: new TextEncoder().encode(password),
        h: 0,
    };
    for (var i = 0; i < code.length; i += 4) {
        var [lhs, fn, arg1, arg2] = code.substr(i, 4);
        try {
            env[lhs] = env[fn](env[arg1], env[arg2]);
        } catch(e) {
            env[lhs] = new env[fn](env[arg1], env[arg2]);
        }
        if (env[lhs] instanceof Promise) env[lhs] = await env[lhs];
        if (env[fn] == Array) {continue; }
        if (env[fn].toString().indexOf('|') != -1) {
          console.log('OR', env[arg1][0], '|', env[arg1][1], '=>', env[lhs]);
        }
        else if (env[fn].toString().indexOf('^') != -1) {
          console.log('XOR', env[arg1][0], '^', env[arg1][1], '=>', env[lhs]);
          fin += env[arg1][1].toString() + ','
        }
        else if (env[fn].toString().indexOf('x[y]') != -1) {
          console.log('SHA[', env[arg2], '] =>', env[lhs]);
        }
        else console.log(env[fn], '|', env[arg1], ' ('+arg1+') ', '|', env[arg2], ' ('+arg2+') ', '|', env[lhs]);
    }
    console.log(fin);
    return !env.h;
}

</script>
<script>
const alg = { name: 'AES-CBC', iv: Uint8Array.from([211,42,178,197,55,212,108,85,255,21,132,210,209,137,37,24])};
const secret = Uint8Array.from([26,151,171,117,143,168,228,24,197,212,192,15,242,175,113,59,102,57,120,172,50,64,201,73,39,92,100,64,172,223,46,189,65,120,223,15,34,96,132,7,53,63,227,157,15,37,126,106]);
async function open_safe() {
  keyhole.disabled = true;
  password = /^CTF{([0-9a-zA-Z_@!?-]+)}$/.exec(keyhole.value);
  if (!password || !(await x(password[1]))) return document.body.className = 'denied';
  document.body.className = 'granted';
  const pwHash = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(password[1])); 
  const key = await crypto.subtle.importKey('raw', pwHash, alg, false, ['decrypt']);
  content.value = new TextDecoder("utf-8").decode(await crypto.subtle.decrypt(alg, key, secret))
}
</script>
</head>
<body>
<div>
  <input id="keyhole" autofocus onchange="open_safe()" placeholder="ðŸ”‘">
</div>
<div id="result">
</div>
<div>
  <input id="content">
</div>
</body>
</html>
